-- This is a site configuration for Gluon v2018.1
--
{
  domain_names = {
    gut = 'Freifunk KreisGT (Stadt GT)'
  },

  domain_director = {
    url = 'http://setup.ipv6.4830.org/dd.php',
    switch_after_offline = 360,
    enabled = true,
  },

  -- 32 bytes of random data, encoded in hexadecimal
  -- This data must be unique among all sites and domains!
  -- Can be generated using: echo $(hexdump -v -n 32 -e '1/1 "%02x"' </dev/urandom)
  -- Generated by »$ printf %04d%056x%04d 4830 0 0; echo«
  domain_seed = '4830000000000000000000000000000000000000000000000000000000000001',

  -- Prefixes used within the mesh.
  -- prefix6 is required, prefix4 can be omitted if next_node.ip4
  -- is not set.
  prefix6 = 'fd10:ca1::/64',

  -- List of NTP servers in your community.
  -- Must be reachable using IPv6!
  ntp_servers = {'ntp.4830.org', 'ntp.services.ffgt.net'},

  -- Wireless configuration for 2.4 GHz interfaces.
  wifi24 = {
    -- Wireless channel.
    channel = 9,

    -- ESSID used for client network.
    ap = {
      ssid = 'l2tp.KreisGT.freifunk.net',
      -- disabled = true, -- (optional)
    },

    mesh = {
      id = '12:42:de:ca:fb:ad',
      mcast_rate = 12000,
      -- disabled = true, (optional)
    },

    -- ibss = {
    --   ssid = '00:42:de:ca:fb:ad',
    --   bssid = '00:42:de:ca:fb:ad',
    --   mcast_rate = 12000,
    --   -- disabled = true, (optional)
    -- },
  },

  -- Wireless configuration for 5 GHz interfaces.
  -- This should be equal to the 2.4 GHz variant, except
  -- for channel.
  wifi5 = {
    channel = 44,
    ap = {
      ssid = 'l2tp.KreisGT.freifunk.net',
      -- disabled = true, -- (optional)
    },

    mesh = {
      id = '12:42:de:ca:fb:ad',
      mcast_rate = 12000,
      -- disabled = true, (optional)
    },

    -- ibss = {
    --   ssid = '00:42:de:ca:fb:ad',
    --   bssid = '00:42:de:ca:fb:ad',
    --   mcast_rate = 12000,
    --   disabled = true,
    -- },
  },

  mesh = {
    -- Options specific to the batman-adv routing protocol (optional)
    -- batman_adv = {
      -- Gateway selection class (optional)
      -- The default class 20 is based on the link quality (TQ) only,
      -- class 1 is calculated from both the TQ and the announced bandwidth
      -- gw_sel_class = 1,
    -- },
    vxlan = false,
  },

  -- The next node feature allows clients to always reach the node it is
  -- connected to using a known IP address.
  next_node = {
    ip6 = 'fd10:ca1::1',
  },

  mesh_vpn = {
    mtu = 1448,

    wireguard = {
      enabled = true,
      iface = 'mesh-vpn',
      regurl = 'http://reg.4830.org:5000/api/v1/wg/key/exchange',
      limit = '1', -- actually unused
      peers = {
        {
          publickey ='mSA2oxzfCc+2hHCHjShJcVM9RM5HOMZJBnVrV0+Zhy0=',
          endpoint ='wg-fra01.4830.org:60001',
          link_address = 'fe80::f000:22ff:fe12:01',
        },
        {
          publickey ='mFb7nunTEvAC6NHNKoQIKDnMv7PITwUyxzXx55vY0Tg=',
          endpoint ='wg-ham01.4830.org:60001',
          link_address = 'fe80::f000:22ff:fe12:02',
        },
      },
    },
  },
}
