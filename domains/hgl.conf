-- This is a site configuration for Gluon v2018.1
--
{
  domain_names = {
    hgl = 'Freifunk Helgoland'
  },

  domain_director = {
    url = 'http://setup.ipv6.4830.org/dd.php',
    switch_after_offline = 360,
    enabled = true,
  },

  -- 32 bytes of random data, encoded in hexadecimal
  -- This data must be unique among all sites and domains!
  -- Can be generated using: echo $(hexdump -v -n 32 -e '1/1 "%02x"' </dev/urandom)
  -- Generated by »echo "Terra Incognita, powered by 4830.org" | awk 'BEGIN{for(n=0; n<256; n++) ord[sprintf("%c",n)]=n;} {newstr=""; for(i=1; i<33; i++) {if(i>length($0)) c="\0"; else c=substr($0, i, 1); newstr=sprintf("%s%02x", newstr, ord[c]);} printf("%-64.64s", newstr)}' ; echo«
  domain_seed = '546572726120496e636f676e6974612c20706f77657265642062792034383330',

  -- Prefixes used within the mesh.
  -- prefix6 is required, prefix4 can be omitted if next_node.ip4
  -- is not set.
  prefix4 = '10.189.0.0/18',
  prefix6 = '2a03:2267:4e16:01ad::/64',

  -- List of NTP servers in your community.
  -- Must be reachable using IPv6!
  -- ntp_servers = {'ntp.4830.org', 'ntp.services.ffgt.net'},
  ntp_servers = {'ntp.ffue','ntp2.ffue','ntp3.ffue','2.openwrt.pool.ntp.org'},

  -- Wireless configuration for 2.4 GHz interfaces.
  wifi24 = {
    -- Wireless channel.
    channel = 1,

    -- ESSID used for client network.
    ap = {
      ssid = 'helgoland.freifunk.net',
      -- disabled = true, -- (optional)
    },

    mesh = {
      id = 'ff-helgo-mesh',
      mcast_rate = 12000,
      -- disabled = true, (optional)
    },
  },

  -- Wireless configuration for 5 GHz interfaces.
  -- This should be equal to the 2.4 GHz variant, except
  -- for channel.
  wifi5 = {
    channel = 44,
    ap = {
      ssid = 'helgoland.freifunk.net',
    },

    mesh = {
      id = 'ff-helgo-mesh',
      mcast_rate = 12000,
    },
  },

  mesh = {
    batman_adv = {
      gw_sel_class = 20,
      routing_algo = 'BATMAN_IV',
    },
    vxlan = false,
  },

  -- The next node feature allows clients to always reach the node it is
  -- connected to using a known IP address.
  next_node = {
    ip4 = '10.189.0.1',
    ip6 = '2a03:2267:4e16:01ad::1',
    mac = '16:41:95:40:f7:dc',
  },

  mesh_vpn = {
    fastd = {
      groups = {
        backbone = {
          limit = 1,
          peers = {
            gw02 = {
              key = '49fed2d52d01e35be758158bdbaa6ca52365c9c847da050cb5f3c67fe32a9d7c',
              remotes = {'"gw02.helgoland.freifunk.net" port 10000'},
            },
            gw03 = {
              key = '73986bd367e8f276c08126e6595448c9b1976dfc61151ae9a399677cca11ac25',
              remotes = {'"gw03.helgoland.freifunk.net" port 10000'},
            },
          },
        },
      },
      bandwidth_limit = {
        enabled = false,
        ingress = 16000,
        egress = 1000,
      },
    },
  },
}
